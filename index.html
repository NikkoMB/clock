<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Home Page</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Satisfy&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Amatic+SC&display=swap" rel="stylesheet">



</head>

<body onload="startTime()" background="public/images/sun.jpg">
    <h1 id="header"></h1>
    <div class="container">
        <div id="time"></div>
        <div id="date"></div>
    </div>
    <div class="weather">
        <div class="location">
        </div>
        <div class='temperature'>
            <div class='temperature-degree'><img id="loading" src="public/images/loading.gif"></div>
        </div>
    </div>
    </div>
</body>

<script>
    'USE STRICT';

    let name = prompt('what is your name?');
    
    let header = document.getElementById('header');

    header.innerHTML = "Welcome " + name;

    window.addEventListener('load', () => {
        let long;
        let latitude;

        let temperatureDegree = document.querySelector('.temperature-degree');
        let locationTimeZone = document.querySelector('.location-timezone');

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(position => {
                long = position.coords.longitude;
                latitude = position.coords.latitude;

                const proxy = 'https://cors-anywhere.herokuapp.com/';
                const api = `${proxy}https://api.darksky.net/forecast/dbb26b5e31beda6c48425ce1e6c306b5/${latitude},${long}`;

                fetch(api)
                    .then(response => {
                        return response.json();
                    })
                    .then(data => {
                        console.log(data);
                        const { temperature, summary, icon } = data.currently;

                        //
                        temperatureDegree.textContent = Math.round(temperature) + ' °F';
                        //


                    });

            });
        }


    });

    let hello = document.getElementById('time');

    function startTime() {
        let now = new Date();
        let hour = now.getHours();
        let minute = now.getMinutes();
        let second = now.getSeconds();
        let ap = "am";
        if (hour > 11) { ap = " pm";}
        if (hour > 17) { document.body.style.backgroundImage = "url('public/images/nightime.jpg')"; }
        if (hour === 0 || hour == 1 || hour == 2 || hour == 3 || hour == 4) { document.body.style.backgroundImage = "url('public/images/nightime.jpg')"; }
        if (hour > 12) { hour = hour - 12; }
        if (hour == 0) { hour = 12; }
        if (minute.toString().length == 1) {
            minute = "0" + minute;
        }
        hello.innerHTML = hour + ':' + minute + ap;
        let t = setTimeout(startTime, 500);
    }

    let todayDate = document.getElementById('date');

    let today = new Date();
    let dd = String(today.getDate()).padStart(2, '0');
    let mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
    let yyyy = today.getFullYear();

    today = mm + '/' + dd + '/' + yyyy;
    todayDate.innerHTML = today;


    /*              Temperature              */
    window.addEventListener('load', () => {
        let long;
        let latitude;
        let temperatureDescription = document.querySelector('.temperature-description');

        let temperatureDegree = document.querySelector('.temperature-degree');
        let locationTimeZone = document.querySelector('.location-timezone');

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(position => {
                long = position.coords.longitude;
                latitude = position.coords.latitude;

                const proxy = 'https://cors-anywhere.herokuapp.com/';
                const api = `${proxy}https://api.darksky.net/forecast/dbb26b5e31beda6c48425ce1e6c306b5/${latitude},${long}`;

                fetch(api)
                    .then(response => {
                        return response.json();
                    })
                    .then(data => {
                        console.log(data);
                        const { temperature, summary, icon } = data.currently;

                        //
                        temperatureDegree.textContent = Math.round(temperature) + ' °F';
                        //


                    });

            });
        }


    });
</script>

</html>