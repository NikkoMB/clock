<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Home Page</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Satisfy&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One&display=swap" rel="stylesheet">


</head>

<body onload="startTime()" background="public/images/cork-board.png">
    <h1 id="header"></h1>
    <div class="container">
        <div id="time"></div>
        <div id="date"></div>
    </div>
    <div class="weather">
        <div class="location">
            <h1 class='location-timezone'>Timezone</h1>
            <canvas class='icon' width="128" height="128"></canvas>
        </div>
        <div class='temperature'>
            <div class='degree-section'>
                <h2 class='temperature-degree'>34</h2>
                <span>F</span>
            </div>
            <div class="temperature-description"></div>
        </div>
    </div>
    </div>
</body>

<script>
    'USE STRICT';

    let name = prompt('what is your name?');
    let header = document.getElementById('header');

    header.innerHTML = "Welcome " + name;

    let hello = document.getElementById('time');

    function startTime() {
        let now = new Date();
        let hour = now.getHours();
        let minute = now.getMinutes();
        let second = now.getSeconds();
        let ap = "am";
        if (hour > 11) { ap = " pm"; }
        if (hour > 12) { hour = hour - 12; }
        if (hour == 0) { hour = 12; }
        if (hour < 10)
            if (minute < 10) { minute = "0" + minute; }
        if (second < 10) { second = "0" + second; }
        hello.innerHTML = hour + ':' + minute + ap;
        let t = setTimeout(startTime, 500);
    }

    let todayDate = document.getElementById('date');

    let today = new Date();
    let dd = String(today.getDate()).padStart(2, '0');
    let mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
    let yyyy = today.getFullYear();

    today = mm + '/' + dd + '/' + yyyy;
    todayDate.innerHTML = today;


    /*              Temperature              */
    window.addEventListener('load', () => {
        let long;
        let latitude;
        let temperatureDescription = document.querySelector('.temperature-description');

        let temperatureDegree = document.querySelector('.temperature-degree');
        let locationTimeZone = document.querySelector('.location-timezone');

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(position => {
                long = position.coords.longitude;
                latitude = position.coords.latitude;

                const proxy = 'https://cors-anywhere.herokuapp.com/';
                const api = `${proxy}https://api.darksky.net/forecast/dbb26b5e31beda6c48425ce1e6c306b5/${latitude},${long}`;

                fetch(api)
                    .then(response => {
                        return response.json();
                    })
                    .then(data => {
                        console.log(data);
                        const { temperature, summary, icon } = data.currently;

                        //
                        temperatureDegree.textContent = temperature;
                        temperatureDescription.textContent = summary;
                        locationTimeZone.textContent = data.timezone.replace(/[_]/g, ' ');
                        //


                    });

            });
        }


    });
</script>

</html>